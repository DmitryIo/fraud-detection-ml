[2022-09-17 10:06:46,475] {taskinstance.py:1179} INFO - Dependencies all met for <TaskInstance: preprocessing_data.validate_model scheduled__2022-09-17T09:34:46.718712+00:00 [queued]>
[2022-09-17 10:06:46,481] {taskinstance.py:1179} INFO - Dependencies all met for <TaskInstance: preprocessing_data.validate_model scheduled__2022-09-17T09:34:46.718712+00:00 [queued]>
[2022-09-17 10:06:46,482] {taskinstance.py:1376} INFO - 
--------------------------------------------------------------------------------
[2022-09-17 10:06:46,482] {taskinstance.py:1377} INFO - Starting attempt 1 of 2
[2022-09-17 10:06:46,482] {taskinstance.py:1378} INFO - 
--------------------------------------------------------------------------------
[2022-09-17 10:06:46,499] {taskinstance.py:1397} INFO - Executing <Task(PythonOperator): validate_model> on 2022-09-17 09:34:46.718712+00:00
[2022-09-17 10:06:46,506] {standard_task_runner.py:52} INFO - Started process 38182 to run task
[2022-09-17 10:06:46,511] {standard_task_runner.py:79} INFO - Running: ['airflow', 'tasks', 'run', 'preprocessing_data', 'validate_model', 'scheduled__2022-09-17T09:34:46.718712+00:00', '--job-id', '423', '--raw', '--subdir', 'DAGS_FOLDER/model_dag.py', '--cfg-path', '/tmp/tmpfenqmrg9', '--error-file', '/tmp/tmpywr8ygpf']
[2022-09-17 10:06:46,512] {standard_task_runner.py:80} INFO - Job 423: Subtask validate_model
[2022-09-17 10:06:46,580] {task_command.py:371} INFO - Running <TaskInstance: preprocessing_data.validate_model scheduled__2022-09-17T09:34:46.718712+00:00 [running]> on host rc1b-dataproc-m-xzxwmqcudfo0foh0.mdb.yandexcloud.net
[2022-09-17 10:06:46,654] {taskinstance.py:1589} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_EMAIL=airflow@example.com
AIRFLOW_CTX_DAG_OWNER=airflow
AIRFLOW_CTX_DAG_ID=preprocessing_data
AIRFLOW_CTX_TASK_ID=validate_model
AIRFLOW_CTX_EXECUTION_DATE=2022-09-17T09:34:46.718712+00:00
AIRFLOW_CTX_TRY_NUMBER=1
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2022-09-17T09:34:46.718712+00:00
[2022-09-17 10:07:06,147] {logging_mixin.py:115} WARNING - 2022/09/17 10:07:06 INFO mlflow.spark: 'runs:/db00a269569e4812b3f9d8e11317b958/model' resolved as 's3://otus-bigdata-dima-ioksha/1/db00a269569e4812b3f9d8e11317b958/artifacts/model'
[2022-09-17 10:07:06,236] {credentials.py:1094} INFO - Found credentials in environment variables.
[2022-09-17 10:07:06,915] {logging_mixin.py:115} WARNING - 2022/09/17 10:07:06 INFO mlflow.spark: URI 's3://otus-bigdata-dima-ioksha/1/db00a269569e4812b3f9d8e11317b958/artifacts/model/sparkml' does not point to the current DFS.
[2022-09-17 10:07:06,915] {logging_mixin.py:115} WARNING - 2022/09/17 10:07:06 INFO mlflow.spark: File 's3://otus-bigdata-dima-ioksha/1/db00a269569e4812b3f9d8e11317b958/artifacts/model/sparkml' not found on DFS. Will attempt to upload the file.
[2022-09-17 10:07:08,236] {logging_mixin.py:115} WARNING - 2022/09/17 10:07:08 INFO mlflow.spark: Copied SparkML model to /tmp/mlflow/43a08f39-1223-4ae2-8e81-7bba26f92951
[2022-09-17 10:07:16,699] {logging_mixin.py:115} WARNING - 2022/09/17 10:07:16 INFO mlflow.spark: 'runs:/db00a269569e4812b3f9d8e11317b958/pipeline' resolved as 's3://otus-bigdata-dima-ioksha/1/db00a269569e4812b3f9d8e11317b958/artifacts/pipeline'
[2022-09-17 10:07:17,472] {logging_mixin.py:115} WARNING - 2022/09/17 10:07:17 INFO mlflow.spark: URI 's3://otus-bigdata-dima-ioksha/1/db00a269569e4812b3f9d8e11317b958/artifacts/pipeline/sparkml' does not point to the current DFS.
[2022-09-17 10:07:17,473] {logging_mixin.py:115} WARNING - 2022/09/17 10:07:17 INFO mlflow.spark: File 's3://otus-bigdata-dima-ioksha/1/db00a269569e4812b3f9d8e11317b958/artifacts/pipeline/sparkml' not found on DFS. Will attempt to upload the file.
[2022-09-17 10:07:18,426] {logging_mixin.py:115} WARNING - 2022/09/17 10:07:18 INFO mlflow.spark: Copied SparkML model to /tmp/mlflow/6f9a0f62-75a8-4e25-be8f-0b05fe871b66
[2022-09-17 10:08:17,826] {validate_model.py:43} INFO - y_test mean 0.07774388064651709
[2022-09-17 10:08:17,826] {validate_model.py:44} INFO - y_pred mean 0.032102838876800925
[2022-09-17 10:10:47,820] {validate_model.py:51} INFO - POINT ESTIMATION OF F1 IS 0.33264790858689713
[2022-09-17 10:10:48,938] {logging_mixin.py:115} WARNING - 2022/09/17 10:10:48 INFO mlflow.spark: 'models:/fraud-transaction-predictor/Production' resolved as 's3://otus-bigdata-dima-ioksha/1/715aa455274b4a219256b46eb9bc680c/artifacts/model'
[2022-09-17 10:10:49,650] {logging_mixin.py:115} WARNING - 2022/09/17 10:10:49 INFO mlflow.spark: URI 's3://otus-bigdata-dima-ioksha/1/715aa455274b4a219256b46eb9bc680c/artifacts/model/sparkml' does not point to the current DFS.
[2022-09-17 10:10:49,650] {logging_mixin.py:115} WARNING - 2022/09/17 10:10:49 INFO mlflow.spark: File 's3://otus-bigdata-dima-ioksha/1/715aa455274b4a219256b46eb9bc680c/artifacts/model/sparkml' not found on DFS. Will attempt to upload the file.
[2022-09-17 10:10:51,031] {logging_mixin.py:115} WARNING - 2022/09/17 10:10:51 INFO mlflow.spark: Copied SparkML model to /tmp/mlflow/fabd53a6-d4d7-49e5-aad6-979786819e33
[2022-09-17 10:10:52,671] {logging_mixin.py:115} WARNING - 2022/09/17 10:10:52 INFO mlflow.spark: 'models:/fraud-transaction-pipeline/Production' resolved as 's3://otus-bigdata-dima-ioksha/1/715aa455274b4a219256b46eb9bc680c/artifacts/pipeline'
[2022-09-17 10:10:53,554] {logging_mixin.py:115} WARNING - 2022/09/17 10:10:53 INFO mlflow.spark: URI 's3://otus-bigdata-dima-ioksha/1/715aa455274b4a219256b46eb9bc680c/artifacts/pipeline/sparkml' does not point to the current DFS.
[2022-09-17 10:10:53,555] {logging_mixin.py:115} WARNING - 2022/09/17 10:10:53 INFO mlflow.spark: File 's3://otus-bigdata-dima-ioksha/1/715aa455274b4a219256b46eb9bc680c/artifacts/pipeline/sparkml' not found on DFS. Will attempt to upload the file.
[2022-09-17 10:10:55,054] {logging_mixin.py:115} WARNING - 2022/09/17 10:10:55 INFO mlflow.spark: Copied SparkML model to /tmp/mlflow/315b0746-9dfc-4af7-ab41-ca1d6f2aca56
[2022-09-17 10:11:40,379] {validate_model.py:43} INFO - y_test mean 0.07774388064651709
[2022-09-17 10:11:40,380] {validate_model.py:44} INFO - y_pred mean 0.006084328565179227
[2022-09-17 10:14:06,395] {validate_model.py:51} INFO - POINT ESTIMATION OF F1 IS 0.13602101026638017
[2022-09-17 10:14:06,999] {validate_model.py:98} INFO - Mean 0.3328106717861873 and std of considering model 0.003172311405919142
[2022-09-17 10:14:07,000] {validate_model.py:99} INFO - Mean 0.13614601148802716 and std of best model 0.0027256713868300574
[2022-09-17 10:14:07,000] {validate_model.py:102} INFO - NEW MODEL IS BETTER
[2022-09-17 10:14:07,029] {logging_mixin.py:115} WARNING - Registered model 'fraud-transaction-predictor' already exists. Creating a new version of this model...
[2022-09-17 10:14:07,101] {logging_mixin.py:115} WARNING - 2022/09/17 10:14:07 INFO mlflow.tracking._model_registry.client: Waiting up to 300 seconds for model version to finish creation.                     Model name: fraud-transaction-predictor, version 3
[2022-09-17 10:14:07,101] {logging_mixin.py:115} WARNING - Created version '3' of model 'fraud-transaction-predictor'.
[2022-09-17 10:14:07,124] {logging_mixin.py:115} WARNING - Registered model 'fraud-transaction-pipeline' already exists. Creating a new version of this model...
[2022-09-17 10:14:07,218] {logging_mixin.py:115} WARNING - 2022/09/17 10:14:07 INFO mlflow.tracking._model_registry.client: Waiting up to 300 seconds for model version to finish creation.                     Model name: fraud-transaction-pipeline, version 3
[2022-09-17 10:14:07,219] {logging_mixin.py:115} WARNING - Created version '3' of model 'fraud-transaction-pipeline'.
[2022-09-17 10:14:07,378] {python.py:173} INFO - Done. Returned value was: None
[2022-09-17 10:14:07,386] {taskinstance.py:1415} INFO - Marking task as SUCCESS. dag_id=preprocessing_data, task_id=validate_model, execution_date=20220917T093446, start_date=20220917T100646, end_date=20220917T101407
[2022-09-17 10:14:07,430] {local_task_job.py:156} INFO - Task exited with return code 0
[2022-09-17 10:14:07,443] {local_task_job.py:273} INFO - 0 downstream tasks scheduled from follow-on schedule check
